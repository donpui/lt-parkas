<!DOCTYPE html>
<html lang="lt">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>LT Transporto Priemonių Analizė</title>
<meta name="description" content="Lietuvos transporto priemonių parko duomenų analizė. Naršykite Regitros atvirus duomenis — markės, modeliai, kategorijos, rida, galia. Veikia naršyklėje, be serverio.">
<meta name="keywords" content="transporto priemonės, Lietuva, Regitra, atviri duomenys, automobiliai, automobilių parkas">
<meta name="author" content="LT Park Analyzer">
<meta name="robots" content="index, follow">
<link rel="icon" type="image/x-icon" href="favicon.ico">

<!-- Open Graph -->
<meta property="og:title" content="LT Transporto Priemonių Analizė">
<meta property="og:description" content="Lietuvos transporto priemonių parko duomenų analizė. Naršykite Regitros atvirus duomenis — markės, modeliai, kategorijos, rida, galia.">
<meta property="og:type" content="website">
<meta property="og:locale" content="lt_LT">

<!-- Twitter Card -->
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="LT Transporto Priemonių Analizė">
<meta name="twitter:description" content="Lietuvos transporto priemonių parko duomenų analizė. Naršykite Regitros atvirus duomenis — markės, modeliai, kategorijos, rida, galia.">

<link rel="stylesheet" href="styles.css">
<script>
  (function() {
    const saved = localStorage.getItem('theme');
    const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
    const theme = saved || (prefersDark ? 'dark' : 'light');
    document.documentElement.setAttribute('data-theme', theme);
  })();
</script>
</head>
<body>

<header class="header">
  <span class="data-version">2026-01-01 duomenų versija</span>
  <h1>LT Transporto Priemonių Parko Duomenys</h1>
  <button class="theme-toggle" id="theme-toggle" type="button" title="Perjungti tamsų / šviesų režimą" aria-label="Perjungti tamsų / šviesų režimą">
    <span class="theme-icon" aria-hidden="true"></span>
  </button>
</header>

<div id="loading" class="loading">
  <div class="spinner"></div>
  <div id="loading-text">Kraunama DuckDB...</div>
  <div class="progress-wrap" id="progress-wrap"><div class="progress-bar" id="progress-bar"></div></div>
  <div class="progress-text" id="progress-text"></div>
</div>

<div id="app" class="app" data-view="table">
  <div class="filters">
    <div class="filter-group">
      <label>Markė</label>
      <div class="combo" id="f-marke"><input type="text" placeholder="Visos"><button class="clear-btn">&times;</button><div class="dropdown"></div></div>
    </div>
    <div class="filter-group">
      <label>Komercinis pav.</label>
      <div class="combo" id="f-komercinis"><input type="text" placeholder="Visi (Shift+click = multi)"><button class="clear-btn">&times;</button><div class="dropdown"></div></div>
    </div>
    <div class="filter-group">
      <label>Kategorija <a href="https://rekvizitai.vz.lt/istatymai/transporto-priemoniu-kategorijos-ir-klases/" class="label-hint" target="_blank" rel="noopener" title="Transporto priemonių kategorijos ir klasės">ⓘ</a></label>
      <div class="combo" id="f-kategorija"><input type="text" placeholder="Visos"><button class="clear-btn">&times;</button><div class="dropdown"></div></div>
    </div>
    <div class="filter-group">
      <label>Metai <span class="label-hint label-hint-clickable" id="metai-hint" data-description="Metai agreguoti pagal logiką - tikrinama, GAMYBOS_METAI, MODELIO_METAI, PIRM_REG_DATA, PIRM_REG_DATA_LT" title="Metai agreguoti pagal logika, pirmiausia GAMYBOS_METAI, MODELIO_METAI, PIRM_REG_DATA, PIRM_REG_DATA_LT">ⓘ</span></label>
      <div class="combo" id="f-metai"><input type="text" placeholder="Visi"><button class="clear-btn">&times;</button><div class="dropdown"></div></div>
    </div>
  </div>

  <div class="filter-actions">
    <a class="more-toggle" id="more-toggle">Daugiau filtrų &#9662;</a>
    <a class="clear-filters" id="clear-filters">Išvalyti filtrus</a>
  </div>

  <div class="filters extra-filters" id="extra-filters">
    <div class="filter-group">
      <label>Darbinis tūris (cm³)</label>
      <input type="text" class="num-filter" id="f-turis" placeholder="pvz.: 1968, >=1500, <3000">
    </div>
    <div class="filter-group">
      <label>Galia (kW)</label>
      <input type="text" class="num-filter" id="f-galia" placeholder="pvz.: 110, >=75, <200">
    </div>
    <div class="filter-group">
      <label>Rida</label>
      <input type="text" class="num-filter" id="f-rida" placeholder="pvz.: <=100000, >50000">
    </div>
    <div class="filter-group">
      <label>Maks. greitis</label>
      <input type="text" class="num-filter" id="f-greitis" placeholder="pvz.: 200, >=180">
    </div>
    <div class="filter-group">
      <label>Apskritis</label>
      <div class="combo" id="f-apskritis"><input type="text" placeholder="Visos"><button class="clear-btn">&times;</button><div class="dropdown"></div></div>
    </div>
    <div class="filter-group">
      <label>Savivaldybė</label>
      <div class="combo" id="f-savivaldybe"><input type="text" placeholder="Visos"><button class="clear-btn">&times;</button><div class="dropdown"></div></div>
    </div>
    <div class="filter-group">
      <label>Valdymo tipas</label>
      <div class="combo" id="f-vald-tipas"><input type="text" placeholder="Visi"><button class="clear-btn">&times;</button><div class="dropdown"></div></div>
    </div>
    <div class="filter-group">
      <label>Kilmės šalis</label>
      <div class="combo" id="f-kilmes-salis"><input type="text" placeholder="Visos"><button class="clear-btn">&times;</button><div class="dropdown"></div></div>
    </div>
    <div class="filter-group">
      <label>Spalva</label>
      <div class="combo" id="f-spalva"><input type="text" placeholder="Visos"><button class="clear-btn">&times;</button><div class="dropdown"></div></div>
    </div>
  </div>

  <div class="view-tabs">
    <button class="view-tab active" data-view="table" type="button">Lentelė</button>
    <button class="view-tab" data-view="map" type="button">Apskričių žemėlapis</button>
    <button class="view-tab" data-view="graph" type="button">Grafikas</button>
    <button class="view-tab" data-view="trends" type="button">Tendencijos</button>
  </div>

  <div class="view view-map" id="view-map">
    <div class="map-card">
      <div class="map-header">
        <div>
          <div class="map-title">Apskričių pasiskirstymas</div>
          <div class="map-subtitle">Skaičius rodo atfiltruotų įrašų kiekį</div>
        </div>
      </div>
      <div class="map-content">
        <div id="lt-map" class="lt-map" role="img" aria-label="Lietuvos apskričių žemėlapis">Kraunamas žemėlapis...</div>
        <div id="map-tooltip" class="map-tooltip" aria-hidden="true"></div>
        <div class="map-meta">
          <div id="map-unknown" class="map-unknown"></div>
          <div class="map-hint">Užveskite pelę ant apskrities, kad matytumėte pavadinimą.</div>
        </div>
      </div>
    </div>
  </div>

  <div class="view view-graph" id="view-graph">
    <div class="graph-card">
      <div class="graph-controls">
        <div class="filter-group">
          <label>Rodyti pagal</label>
          <select id="graph-dimension" class="select-input">
            <option value="SPALVA">Spalva</option>
            <option value="AGR_CAR_YEAR">Metai</option>
            <option value="VALD_TIPAS">Valdymo tipas</option>
            <option value="KILMES_SALIS">Kilmės šalis</option>
            <option value="DEGALAI">Degalai</option>
            <option value="KATEGORIJA_KLASE">Kategorija</option>
            <option value="APSKRITIS">Apskritis</option>
            <option value="SAVIVALDYBE">Savivaldybė</option>
          </select>
        </div>
        <div class="filter-group">
          <label>Maks. kategorijų</label>
          <input type="text" class="num-filter" id="graph-limit" value="15" placeholder="pvz.: 20 (0 = visi)">
        </div>
        <div class="filter-group">
          <label>Rikiuoti</label>
          <select id="graph-sort" class="select-input">
            <option value="count">Pagal skaičių</option>
            <option value="label">Pagal pavadinimą</option>
          </select>
        </div>
        <div class="filter-group checkbox-group">
          <label><input type="checkbox" id="graph-include-unknown" checked> Rodyti „Nežinoma“</label>
        </div>
      </div>
      <div class="graph-meta">
        <div class="graph-title" id="graph-title">Grafikas</div>
        <div class="graph-subtitle" id="graph-subtitle"></div>
      </div>
      <div id="graph-bars" class="graph-bars"></div>
    </div>
  </div>

  <div class="view view-trends" id="view-trends">
    <div class="trends-card">
      <div class="trends-controls">
        <div class="filter-group">
          <label>Nuo metų</label>
          <input type="number" id="trends-year-from" class="num-filter" value="2015" min="1900" max="2099">
        </div>
        <div class="filter-group">
          <label>Iki metų</label>
          <input type="number" id="trends-year-to" class="num-filter" value="2025" min="1900" max="2099">
        </div>
      </div>
      <div class="trends-meta">
        <div class="trends-title" id="trends-title">Registracijų tendencijos</div>
        <div class="trends-subtitle" id="trends-subtitle"></div>
      </div>
      <div class="trends-chart-wrap">
        <canvas id="trends-canvas"></canvas>
      </div>
    </div>
  </div>

  <div class="view view-table" id="view-table">
  <div class="info-bar">
    <span><span id="count">-</span><span class="mini-spinner"></span></span>
    <span id="query-time"></span>
  </div>

  <div class="table-wrap">
    <table>
      <thead>
        <tr id="thead-row">
          <th data-col="AGR_MARKE">Markė</th>
          <th data-col="KOMERCINIS_PAV">Komercinis pav.</th>
          <th data-col="VALD_TIPAS">Valdymo tipas</th>
          <th data-col="KILMES_SALIS">Kilmės šalis</th>
          <th data-col="KATEGORIJA_KLASE">Kategorija</th>
          <th data-col="KEB_PAVADINIMAS">Kėbulas</th>
          <th data-col="DEGALAI">Degalai</th>
          <th data-col="GALIA">Galia (kW)</th>
          <th data-col="DARBINIS_TURIS">Tūris (cm³)</th>
          <th data-col="AGR_CAR_YEAR">Modelio metai</th>
          <th data-col="PIRM_REG_DATA">Pirma reg.</th>
          <th data-col="RIDA">Rida</th>
          <th data-col="SPALVA">Spalva</th>
          <th data-col="SAVIVALDYBE">Savivaldybė</th>
        </tr>
      </thead>
      <tbody id="tbody"></tbody>
    </table>
  </div>

  <div class="pagination">
    <button id="btn-prev" disabled>&larr; Ankstesnis</button>
    <span id="page-info">-</span>
    <button id="btn-next" disabled>Kitas &rarr;</button>
  </div>
  </div>
</div>

<div class="modal-overlay" id="modal">
  <div class="modal">
    <div class="modal-header">
      <h2 id="modal-title">Informacija</h2>
      <button class="modal-close" id="modal-close">&times;</button>
    </div>
    <div class="modal-body">
      <div id="modal-info" class="modal-info" hidden><p id="modal-info-text"></p></div>
      <table class="detail-table" id="modal-table"><tbody id="modal-body"></tbody></table>
    </div>
  </div>
</div>

<footer class="app-footer">Donatas Puidokas © 2026 — pagaminta su Claude (pabarstyta Codex'u) - atviri duomenys <a href="https://data.gov.lt/" target="_blank" rel="noopener noreferrer">data.gov.lt</a> <a href="https://github.com/donpui/lt-parkas" target="_blank" rel="noopener noreferrer" class="footer-github" aria-label="GitHub repozitorija">
    <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/></svg>
  </a></footer>

<script type="module" src="app.js"></script>

</body>
</html>
